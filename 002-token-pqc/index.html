<!doctype html>
<html class="not-ready lg:text-base" lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <!-- Title -->
  <title>
    Web Tokens in a Post Quantum Era - Armand Kamary
  </title>

  <!-- Meta -->
  <meta name="theme-color" />

  
  <!-- Author -->
  
  <!---->
  
  <!---->
  
  <!---->
  
  <!---->
  
  <!---->
  <meta name="description" content="The quantum computing is changing how we think about web tokens security." />
  <meta name="author" content="Armand Kamary" />
  <!-- The Open Graph protocol -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Web Tokens in a Post Quantum Era" />
  <meta property="og:site_name" content="Armand Kamary" />
  <meta property="og:description" content="The quantum computing is changing how we think about web tokens security." />
  <meta property="og:url" content="https:&#x2F;&#x2F;kamarya.github.io&#x2F;002-token-pqc&#x2F;" />
  
  <!---->
  
  <!---->
  

  <!-- CSS & JS -->
  <link rel="preload stylesheet" as="style" href="https://kamarya.github.io/main.css" />
  <style>
    :root {
      --bg: #f4f4f5;
      --bg-dark: #18181b;
      --header: #e4e4e7;
      --header-dark: #27272a;
    }
  </style>

  

  <!-- Dark Icon -->
  <link rel="preload" as="image" href="https://kamarya.github.io/icons/theme.svg" />

  <!-- Math -->
  
  <!---->
  <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16/dist/katex.min.css"
  crossorigin="anonymous"
/>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16/dist/katex.min.js"
  crossorigin="anonymous"
></script>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16/dist/contrib/auto-render.min.js"
  crossorigin="anonymous"
></script>

<script>
  document.addEventListener("DOMContentLoaded", () =>
    renderMathInElement(document.body, {
      // customised options
      // • auto-render specific keys, e.g.:
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ],
      // • rendering keys, e.g.:
      throwOnError: false,
    }),
  );
</script>

  <!---->
  
  <!---->

  <!-- Mermaid -->
  
  <!---->

  <!-- Favicon -->
  <link rel="icon" href="https://kamarya.github.io/favicon.ico" />
  <link rel="apple-touch-icon" href="https://kamarya.github.io/apple-touch-icon.png" />

  <!-- Feeds -->
  

  <!-- Canonical -->
  <link rel="canonical" href="https:&#x2F;&#x2F;kamarya.github.io&#x2F;002-token-pqc&#x2F;" />

  <!-- Head inject -->
  <style>
/* 1. Remove the border and padding from the container */
  .not-prose.mr-5.shrink-0.rounded-full {
    border: none !important;
    padding: 2px !important;
    background: #FFD700 !important;
    box-shadow: none !important;
  }

  /* 2. Stop the spinning animation */
  .hover\:animate-spin:hover {
    animation: none !important;
    transform: none !important;
  }

  /* 3. Increase the size of the avatar */
  /* w-16 is 4rem (64px). We will set it to 8rem (128px) */
  .w-16 {
    width: 8rem !important;
    height: 8rem !important;
  }
</style>
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header
  class="header fixed top-0 z-40 mx-auto min-h-[3.5rem] w-full"
>
  <div class="mx-auto w-full max-w-4xl p-3 lg:flex lg:justify-between">
    <div class="flex justify-between">
      <div class="flex items-center">
        <a class="text-2xl font-semibold" href="https://kamarya.github.io">Armand Kamary</a>
        <div
          class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0px] [background:url(./icons/theme.svg)_left_center/cover_no-repeat] dark:[background-position:right] dark:invert"
          role="button"
          aria-label="Dark"
        ></div>
      </div>
      
      <div
        class="btn-menu relative z-50 flex h-8 w-8 shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
        role="button"
        aria-label="Menu"
      ></div>
      
    </div>
    <script>
      // base
      const htmlClass = document.documentElement.classList;
      setTimeout(() => {
        htmlClass.remove("not-ready");
      }, 10);

      // mobile menu
      const btnMenu = document.querySelector(".btn-menu");
      btnMenu?.addEventListener("click", () => {
        htmlClass.toggle("open");
      });

      // dark theme
      const setDark = (isDark) => {
        if (isDark) {
          document.body.dispatchEvent(new CustomEvent("set-theme", { detail: "dark" }));
          htmlClass.add("dark");
        } else {
          document.body.dispatchEvent(new CustomEvent("set-theme", { detail: "light" }));
          htmlClass.remove("dark");
        }
        localStorage.setItem("dark", isDark);
      };

      // init
      const darkScheme = window.matchMedia("(prefers-color-scheme: dark)");
      if (htmlClass.contains("dark")) {
        setDark(true);
      } else {
        const darkVal = localStorage.getItem("dark");
        setDark(darkVal ? darkVal === "true" : darkScheme.matches);
      }

      // listen system
      darkScheme.addEventListener("change", (event) => {
        setDark(event.matches);
      });

      // manual switch
      const btnDark = document.querySelector(".btn-dark");
      btnDark.addEventListener("click", () => {
        setDark(localStorage.getItem("dark") !== "true");
      });
    </script>
    
    <nav class="flex w-full items-center lg:w-auto">
      <ul
        class="nav-wrapper flex w-full flex-col py-2 lg:w-auto lg:flex-row lg:self-center lg:py-0"
      >
        
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://kamarya.github.io/archive"
            >Archive</a
          >
        </li>
        
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://kamarya.github.io/tags"
            >Tags</a
          >
        </li>
        
      </ul>
      <!-- Header Nav inject -->
      
    </nav>
    
  </div>
</header>


    <!-- Body Start inject -->
    

    <div class="flex">
      <div class="order-1 hidden w-[calc((100%-var(--container-3xl))/2)] lg:block"></div>
      <aside
        class="sticky top-0 order-3 mt-48 hidden h-min w-[calc((100%-var(--container-3xl))/2)] lg:block"
      >
        
<nav
  class="prose prose-neutral dark:prose-invert prose-a:block prose-a:truncate prose-a:font-normal prose-a:secondary-link max-h-lvh overflow-y-auto px-2 pt-18 pb-4"
>
  <b class="ml-1.5">Table of Contents</b>
  <ul>
    
    <li>
      <a href="#introduction">Introduction</a>
      
    </li>
    
    <li>
      <a href="#why-the-hard-math-is-getting-easier">Why the &quot;Hard Math&quot; is Getting Easier</a>
      
    </li>
    
    <li>
      <a href="#the-boring-security-of-opaque-tokens">The &quot;Boring&quot; Security of Opaque Tokens</a>
      
    </li>
    
    <li>
      <a href="#where-stateless-tokens-go-from-here">Where Stateless Tokens Go From Here</a>
      
    </li>
    
    <li>
      <a href="#what-we-should-actually-do-today">What We Should Actually Do Today</a>
      
    </li>
    
  </ul>
</nav>


      </aside>
      <main
        class="prose prose-neutral dark:prose-invert prose-pre:rounded-lg prose-img:rounded-lg order-2 mx-auto min-h-[calc(100vh-9rem)] w-full max-w-3xl px-4 pt-24 pb-16 break-words lg:pt-32"
      >
        
<article>
  <!-- Page Start inject -->
  

  <header class="mb-16">
    <h1 class="my-0! pb-2.5">Web Tokens in a Post Quantum Era</h1>
    <div class="text-sm antialiased opacity-60">
  
  <time>2025-12-31</time>
  <span class="mx-1">&middot;</span>
  <span>5min</span>
  <!---->
  <!---->
  <!---->
  <!---->
  
  <span class="mx-1">&middot;</span>
  <span>Armand Kamary</span>
  
  <!-- Page Info inject -->
  
</div>

  </header>

  

  <!-- TOC -->
  
<nav class="block-bg prose-a:secondary-link mb-12 flex rounded-lg p-2 text-lg">
  <details>
    <summary class="cursor-pointer py-1 pl-4">
      <span class="ml-2">Table of Contents</span>
    </summary>
    <ul class="mx-2">
      
      <li>
        <a href="#introduction">Introduction</a>
        
      </li>
      
      <li>
        <a href="#why-the-hard-math-is-getting-easier">Why the &quot;Hard Math&quot; is Getting Easier</a>
        
      </li>
      
      <li>
        <a href="#the-boring-security-of-opaque-tokens">The &quot;Boring&quot; Security of Opaque Tokens</a>
        
      </li>
      
      <li>
        <a href="#where-stateless-tokens-go-from-here">Where Stateless Tokens Go From Here</a>
        
      </li>
      
      <li>
        <a href="#what-we-should-actually-do-today">What We Should Actually Do Today</a>
        
      </li>
      
    </ul>
  </details>
</nav>

<!---->

  <!-- Content -->
  <section><h2 id="introduction">Introduction</h2>
<p>I’ve been spending a lot of time lately thinking about Y2Q a.k.a. Q-Day. It’s that looming, undefined date when quantum computers become powerful enough to render our current encryption standards obsolete. For most of us, this feels like a problem for the distant future, but in the world of web tokens and identity, the "Post-Quantum" era has already started to influence how we build.</p>
<p>The real threat isn't just a future computer; it’s the "Harvest Now, Decrypt Later" strategy. Malicious actors are already scooping up encrypted traffic today, betting on the fact that they can crack it open in a decade. If your tokens carry sensitive data or grant long-term access, that clock is already ticking.</p>
<img src="../img/y2q.png" alt="Q-Day"/>
<h2 id="why-the-hard-math-is-getting-easier">Why the "Hard Math" is Getting Easier</h2>
<p>Most of us rely on JWTs signed with RSA or Elliptic Curve (ECDSA) algorithms. We use them because they are fast and universally supported. However, these rely on mathematical problems—like factoring large primes—that are incredibly difficult for classical computers but trivial for a quantum computer running Shor’s Algorithm.</p>
<p>If an attacker can use a quantum computer to derive your private key from your public key, the game is over. They don't just steal one token; they gain the ability to forge any token they want, effectively becoming a ghost in your machine.</p>
<h2 id="the-boring-security-of-opaque-tokens">The "Boring" Security of Opaque Tokens</h2>
<p>Surprisingly, the most "quantum-resistant" solution is also one of the oldest: the simple, boring Opaque Token. Because an opaque token is just a high-entropy random string stored in a database, there is no underlying math to "crack." A quantum computer is no better at guessing a truly random 256-bit string than a regular laptop is.</p>
<p>If your architecture allows for it, sticking with stateful, opaque tokens is actually the safest move you can make right now. It trades a bit of speed (because of the database lookup) for a massive amount of long-term security.</p>
<h2 id="where-stateless-tokens-go-from-here">Where Stateless Tokens Go From Here</h2>
<p>We can't always use opaque tokens, though. In microservices, we need the "value" that stateless tokens like JWT or PASETO provide. This is where things get interesting.</p>
<p>The industry is currently pivoting toward Post-Quantum Cryptography (PQC). You’ll start hearing a lot more about algorithms like <strong>ML-DSA</strong> (formerly Dilithium). Unlike the math we use today, these are "lattice-based," which even quantum computers struggle to navigate.</p>
<p>If you are looking for a modern path, I’d keep a close eye on <strong>PASETO</strong>. Unlike JWT, which is a bit of a "choose your own adventure" when it comes to security, PASETO is designed to be versioned. The upcoming <a href="https://github.com/paseto-standard/paseto-spec/pull/36">Post-Quantum PASETO (v5, v6)</a> are specifically built to swap out vulnerable curves for these new, quantum-safe signatures. It’s a much cleaner transition than trying to patch the older JWT standard.</p>
<h2 id="what-we-should-actually-do-today">What We Should Actually Do Today</h2>
<p>You don't need to rewrite your entire auth service this afternoon. But if you’re making architectural decisions now, there are two things worth doing.</p>
<p>First, if you're using symmetric signing (like HMAC-SHA256), make sure your secrets are at least 256 bits long. While quantum computers can speed up brute-force attacks (Grover’s Algorithm), they don't "break" symmetric encryption the way they break RSA. Doubling your key size is a cheap and effective shield.</p>
<p>Second, start auditing where you use long-lived asymmetric keys. If you’re building something meant to last ten years, it’s time to start experimenting with hybrid approaches layering a traditional signature with a post-quantum one.</p>
<p>The shift to a post-quantum world isn't going to happen overnight, but the decisions we make about our tokens today will determine how much we have to panic when that day finally arrives.</p>
<table><thead><tr><th style="text-align: left">Token Type</th><th style="text-align: left">Category</th><th style="text-align: left">Primary Feature</th><th style="text-align: left">Cryptography</th><th style="text-align: left">Pros</th><th style="text-align: left">Cons</th></tr></thead><tbody>
<tr><td style="text-align: left"><strong>Opaque Token</strong></td><td style="text-align: left">Reference</td><td style="text-align: left">Simple random string</td><td style="text-align: left">N/A (Stored in DB)</td><td style="text-align: left">Instant revocation; payload is never exposed.</td><td style="text-align: left">Requires DB lookup for every request (slower).</td></tr>
<tr><td style="text-align: left"><strong>JWT</strong></td><td style="text-align: left">Value</td><td style="text-align: left">Industry standard</td><td style="text-align: left">Asymmetric or Symmetric</td><td style="text-align: left">Universal support; stateless validation.</td><td style="text-align: left">Security pitfalls (alg: none); hard to revoke.</td></tr>
<tr><td style="text-align: left"><strong>PASETO</strong></td><td style="text-align: left">Value</td><td style="text-align: left">"Secure by default" JWT</td><td style="text-align: left">Asymmetric or Symmetric</td><td style="text-align: left">No "header" attacks; uses modern crypto (Ed25519).</td><td style="text-align: left">Smaller ecosystem; less library support than JWT.</td></tr>
<tr><td style="text-align: left"><strong>Macaroon</strong></td><td style="text-align: left">Value</td><td style="text-align: left">Attenuation (Caveats)</td><td style="text-align: left">Symmetric (HMAC)</td><td style="text-align: left">Users can add restrictions to their own tokens.</td><td style="text-align: left">Harder to use with Public Keys; verification is complex.</td></tr>
<tr><td style="text-align: left"><strong>Biscuit</strong></td><td style="text-align: left">Value</td><td style="text-align: left">Logic-based (Datalog)</td><td style="text-align: left">Asymmetric</td><td style="text-align: left">Powerful rules (IP, time, etc.); offline delegation.</td><td style="text-align: left">Higher CPU overhead for rule processing.</td></tr>
<tr><td style="text-align: left"><strong>Branca</strong></td><td style="text-align: left">Value</td><td style="text-align: left">Encrypted Payload</td><td style="text-align: left">Symmetric (XChaCha20)</td><td style="text-align: left">Payload is 100% private; simple and tamper-proof.</td><td style="text-align: left">Requires shared secret; client cannot read its own info.</td></tr>
<tr><td style="text-align: left"><strong>mTLS</strong></td><td style="text-align: left">Protocol</td><td style="text-align: left">Certificate-based</td><td style="text-align: left">X.509 / PKI</td><td style="text-align: left">No bearer token to steal; extremely high security.</td><td style="text-align: left">Complex certificate management; hard to use for web apps.</td></tr>
</tbody></table>
<p align="left" style="color:gray;opacity: 0.6;">
  <small><em>This article's core concepts and structure are my own; the prose was polished and corrected with the help of an LLM.</em></small>
</p></section>

  <hr />

  <!-- Post Taxonomies -->
  
<footer class="mt-12 flex flex-col">
  <!---->
  <!---->
  <!---->
  <!---->
  
  <div class="mb-2 flex flex-wrap">
    <span class="block-bg mr-1.5 mb-1.5 rounded-lg px-5 py-1.5">Tags </span>
    
    <a
      class="block-bg block-hover mr-1.5 mb-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://kamarya.github.io/tags/pqc/"
      >PQC</a
    >
    
    <a
      class="block-bg block-hover mr-1.5 mb-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://kamarya.github.io/tags/jwt/"
      >JWT</a
    >
    
    <a
      class="block-bg block-hover mr-1.5 mb-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://kamarya.github.io/tags/security/"
      >Security</a
    >
    
    <a
      class="block-bg block-hover mr-1.5 mb-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://kamarya.github.io/tags/web-access-token/"
      >Web Access Token</a
    >
    
  </div>
  
</footer>

<!---->

  <!-- Post Nav -->
  
<nav class="block-bg mt-12 flex flex-wrap rounded-lg text-lg">
  
  <a
    class="block-hover-mask flex min-w-[50%] grow items-center rounded-l-md p-6 pr-3 font-semibold no-underline"
    href="https:&#x2F;&#x2F;kamarya.github.io&#x2F;001-ftn&#x2F;"
    ><span class="mr-1.5">←</span><span>Breaking the Speed Limit: Improved Receivers for FTN Signaling</span></a
  >
  <!---->
  
</nav>

<!---->

  <!-- Comment -->
  

  <!-- Page End inject -->
  
</article>

      </main>
    </div>

    <footer class="mx-auto flex max-w-3xl flex-wrap items-center px-8 py-4 text-sm opacity-60">
  <div class="mr-auto basis-full lg:basis-1/2">
    <!---->
    <!---->
    &copy; 2009 - 2026<!---->
    
    <a class="link" href="https://kamarya.github.io">
      Armand Kamary
    </a>
     |<!---->
    <!---->
    <a class="link" href="https:&#x2F;&#x2F;creativecommons.org&#x2F;licenses&#x2F;by-sa&#x2F;4.0&#x2F;" rel="noopener" target="_blank">
      CC BY-SA 4.0
    </a>
    <!---->
    
  </div>
  <!-- Footer inject -->
  
</footer>


    <!-- Body End inject -->
    
  </body>
</html>
